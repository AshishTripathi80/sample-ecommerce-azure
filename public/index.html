<!DOCTYPE html>
<html>
<head>
  <title>Sample E-Commerce</title>
</head>
<body>
  <h1>Welcome to Sample E-Commerce</h1>
  <p>Here are some products:</p>
  <ul id="product-list"></ul>

  <h3>Product Image (from Blob Storage later):</h3>
  <img src="https://ecommercestorageashish.blob.core.windows.net/product-images/Laptop.jpg?sp=r&st=2025-09-07T06:02:35Z&se=2025-09-14T14:17:35Z&spr=https&sv=2024-11-04&sr=b&sig=Gjpm0cisplGu4Dms3h9a88f7vE%2B%2FYM5W6du1ewdA0Sw%3D" width="200" />

  <script>
    fetch("/api/products")
      .then(res => res.json())
      .then(products => {
        const list = document.getElementById("product-list");
        products.forEach(p => {
          const item = document.createElement("li");
  
          const name = p.Name || p.name || 'Unknown Product';
          const price = p.Price || p.price || 'N/A';
  
          item.textContent = `${name} - $${price} `;
  
          // Create order button
          const btn = document.createElement("button");
          btn.textContent = "Order";
          btn.onclick = async () => {
            try {
              const response = await fetch("/api/orders", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ productId: p.Id || p.id, quantity: 1 })
              });
              const result = await response.json();
              alert(result.message || "Order processed");
            } catch (err) {
              alert("Failed to place order");
              console.error(err);
            }
          };
  
          item.appendChild(btn);
          list.appendChild(item);
        });
      })
      .catch(err => {
        console.error('Error fetching products:', err);
        document.getElementById("product-list").innerHTML = '<li>Error loading products</li>';
      });
  </script>
  
</body>
</html>